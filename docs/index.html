<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SDU Shield Explorer</title>
  <style>
    html, body { height:100%; margin:0; font-family: monospace; background:#1e1e1e; color:#ddd; }
    .grid {
      display:grid;
      grid-template-columns: 250px 1fr;
      grid-template-rows: auto auto 1fr;
      grid-template-areas:
        "sidebar header"
        "sidebar controls"
        "sidebar viewer";
      height:100%;
    }
    #sidebar {
      grid-area: sidebar;
      background:#2d2d2d; padding:10px; overflow-y:auto;
    }
    #sidebar h3 { margin-top:0; }
    #sidebar ul { list-style:none; padding-left:10px; }
    #sidebar li { cursor:pointer; user-select:none; margin:4px 0; }
    #sidebar li::before { content:"‚ñ∫ "; }
    #sidebar li.expanded::before { content:"‚ñº "; }
    #sidebar li.file::before { content:"üìÑ "; }

    #header {
      grid-area: header;
      display:flex; align-items:center;
      background:#333; padding:8px; border-bottom:1px solid #444;
    }
    #back-btn, #forward-btn, #env-toggle, #search-btn {
      background:#444; color:#fff; border:none; padding:4px 8px; margin-right:8px; cursor:pointer;
    }
    #back-btn.disabled, #forward-btn.disabled { opacity:.4; cursor:default; }
    #path-display { flex-shrink:0; color:#569cd6; cursor:pointer; margin-right:16px; display:flex; }
    #path-display span { margin-right:4px; }
    #path-display span:hover { text-decoration:underline; }
    #env-toggle.active { background:#0e639c; }
    #search-btn { font-size:18px; padding:4px; }
    #search { flex:1; background:#222; color:#ddd; border:1px solid #444; padding:4px 8px; margin-left:4px; }

    #controls { grid-area: controls; padding:6px 8px; background:#2a2a2a; border-bottom:1px solid #444; }

    #viewer {
      grid-area: viewer;
      padding:12px; overflow-y:auto;
    }
    .file-item {
      display:flex; justify-content:space-between; align-items:center;
      padding:6px 0; border-bottom:1px solid #2d2d2d;
    }
    .file-item a { color:#569cd6; text-decoration:none; font-size:16px; }
    .file-item a:hover { text-decoration:underline; }
    .download-btn {
      background:transparent; border:none; font-size:20px; color:#0e639c; cursor:pointer;
    }
    .download-btn:hover { color:#1177bb; }

    #doc-view {
      white-space:pre-wrap; background:#252526; padding:8px; border:1px solid #444;
      margin-top:12px; min-height:200px;
    }
    #copy-btn {
      margin-top:8px; background:#0e639c; border:none; color:#fff; padding:4px 8px; cursor:pointer;
      display:none;
    }
    #copy-btn:hover { background:#1177bb; }
  </style>
</head>
<body>
  <div class="grid">
    <!-- Sidebar: Path Tree -->
    <div id="sidebar">
      <h3>üìÅ File Tree</h3>
      <ul id="path-tree"></ul>
    </div>

    <!-- Header: Back/Forward, Breadcrumbs, Env toggle, Search -->
    <div id="header">
      <button id="back-btn">‚óÄ</button>
      <button id="forward-btn">‚ñ∂</button>
      <div id="path-display"></div>
      <button id="env-toggle">[LOCAL]</button>
      <button id="search-btn">üîç</button>
      <input id="search" placeholder="Search..." />
    </div>

    <!-- Controls placeholder if needed -->
    <div id="controls"></div>

    <!-- Viewer: file list or content -->
    <div id="viewer">
      <div id="doc-view"></div>
      <button id="copy-btn">Copy</button>
    </div>
  </div>

  <script>
    // Dummy file tree data
    const treeData = {
      "C:": {
        "1st semester p": {},
        "ArduinoCodes": {
          "ControllerArc": {
            ".pio": {},
            "build": {
              "nanoatmega.hex": "file",
              "nanoatmega.bin": "file"
            },
            "libdeps": {},
            ".vscode": {},
            "__MACOSX": {},
            "include": {},
            "lib": {},
            "src": {
              "main.c": "file"
            },
            "test": {}
          }
        },
        "Virtual": {}
      }
    };

    // State
    let env = "LOCAL", current = "C:";
    let hist = [], pos = -1;

    // Element refs
    const treeRoot = document.getElementById("path-tree"),
          pathDisp = document.getElementById("path-display"),
          backBtn  = document.getElementById("back-btn"),
          fwdBtn   = document.getElementById("forward-btn"),
          envToggle= document.getElementById("env-toggle"),
          searchBtn= document.getElementById("search-btn"),
          searchEl = document.getElementById("search"),
          viewer   = document.getElementById("viewer"),
          docView  = document.getElementById("doc-view"),
          copyBtn  = document.getElementById("copy-btn"),
          header   = document.getElementById("header");

    // History funcs
    function updateNav(){
      backBtn.disabled = pos<=0;
      fwdBtn.disabled  = pos>=hist.length-1;
      backBtn.classList.toggle("disabled", backBtn.disabled);
      fwdBtn.classList.toggle("disabled", fwdBtn.disabled);
    }
    function pushHist(p){
      hist=hist.slice(0,pos+1); hist.push(p); pos++; updateNav();
    }
    backBtn.onclick = ()=>{ if(pos>0) navigate(hist[--pos],false); };
    fwdBtn.onclick  = ()=>{ if(pos<hist.length-1) navigate(hist[++pos],false); };
    window.onmousedown = e=>{
      if(e.button===3) backBtn.click();
      if(e.button===4) fwdBtn.click();
    };

    // Build tree
    function buildTree(node, ul, prefix=""){
      for(const key in node){
        const li = document.createElement("li");
        li.textContent = key;
        ul.appendChild(li);
        const childUl = document.createElement("ul");
        childUl.style.display = "none";
        li.appendChild(childUl);

        if(typeof node[key]==="object"){
          li.classList.add("folder");
          li.onclick = e=>{
            e.stopPropagation();
            const exp = li.classList.toggle("expanded");
            childUl.style.display = exp?"block":"none";
            navigate(prefix? prefix+"/"+key : key);
          };
          buildTree(node[key], childUl, prefix? prefix+"/"+key : key);
        } else {
          li.classList.add("file");
          li.onclick = e=>{
            e.stopPropagation();
            navigate(prefix? prefix+"/"+key : key);
          };
        }
      }
    }

    // Render breadcrumbs & viewer
    function navigate(path, push=true){
      if(push) pushHist(path);
      current=path;
      // breadcrumbs
      pathDisp.innerHTML="";
      path.split("/").forEach((seg,i)=>{
        const acc = path.split("/").slice(0,i+1).join("/");
        const sp = document.createElement("span");
        sp.textContent = seg;
        sp.onclick = ()=>navigate(acc);
        pathDisp.appendChild(sp);
      });
      // display
      viewer.innerHTML="";
      copyBtn.style.display="none";
      if(treeData[ current.split(":")[0] ]){
        // folder: list children
        const parts=current.split(":")[1].split("/").filter(Boolean);
        let node=treeData[current.split(":")[0]];
        parts.forEach(p=>node=node[p]);
        for(const name in node){
          const row=document.createElement("div");
          row.className="file-item";
          const a=document.createElement("a");
          a.textContent = (typeof node[name]==="object"?"üìÅ ":"üìÑ ")+name;
          a.href="#"; a.onclick=e=>{e.preventDefault();navigate(current+"/"+name);};
          row.appendChild(a);
          if(node[name]==="file"){
            const dl=document.createElement("button");
            dl.className="download-btn"; dl.textContent="üì•";
            row.appendChild(dl);
          }
          viewer.appendChild(row);
        }
      }
      // file preview
      const parts=current.split(":")[1].split("/").filter(Boolean);
      let node=treeData[current.split(":")[0]];
      parts.forEach(p=>node=node[p]);
      if(node==="file"){
        docView.textContent = `Contents of ${current}`;
        viewer.appendChild(docView);
        copyBtn.style.display="inline-block";
      }
    }

    // Copy preview
    copyBtn.onclick = ()=>navigator.clipboard.writeText(docView.textContent);

    // Search
    searchBtn.onclick = ()=> {
      const q=searchEl.value.trim().toLowerCase();
      viewer.innerHTML="";
      // simple search across current folder
      const parts=current.split(":")[1].split("/").filter(Boolean);
      let node=treeData[current.split(":")[0]];
      parts.forEach(p=>node=node[p]);
      Object.keys(node).filter(n=>n.toLowerCase().includes(q)).forEach(name=>{
        const row=document.createElement("div"); row.className="file-item";
        const a=document.createElement("a");
        a.textContent=(typeof node[name]==="object"?"üìÅ ":"üìÑ ")+name;
        row.appendChild(a);
        viewer.appendChild(row);
      });
    };

    // Highlight header
    header.onclick = e=>{ if(e.target===pathDisp) header.classList.toggle("highlight"); };

    // Init
    window.onload = ()=>{
      buildTree(treeData["C:"], treeRoot, "C:");
      envToggle.textContent=`[${env}]`;
      navigate("C:");
    };
  </script>
</body>
</html>
